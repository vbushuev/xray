/*
 jQuery Cookie Plugin v1.4.1
 https://github.com/carhartl/jquery-cookie

 Copyright 2006, 2014 Klaus Hartl
 Released under the MIT license
*/
var $jscomp={scope:{},findInternal:function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");console.debug("jquery is here: "+typeof $);
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?module.exports=a(require("jquery")):a(jQuery)})(function(a){function b(a){a=e.json?JSON.stringify(a):String(a);return e.raw?a:encodeURIComponent(a)}function c(b,c){var f;if(e.raw)f=b;else a:{var h=b;0===h.indexOf('"')&&(h=h.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{h=decodeURIComponent(h.replace(d," "));f=e.json?JSON.parse(h):h;break a}catch(m){}f=void 0}return a.isFunction(c)?c(f):
f}var d=/\+/g,e=a.cookie=function(d,l,g){if(1<arguments.length&&!a.isFunction(l)){g=a.extend({},e.defaults,g);if("number"===typeof g.expires){var f=g.expires,m=g.expires=new Date;m.setMilliseconds(m.getMilliseconds()+864E5*f)}return document.cookie=[e.raw?d:encodeURIComponent(d),"=",b(l),g.expires?"; expires="+g.expires.toUTCString():"",g.path?"; path="+g.path:"",g.domain?"; domain="+g.domain:"",g.secure?"; secure":""].join("")}for(var f=d?void 0:{},m=document.cookie?document.cookie.split("; "):[],
p=0,q=m.length;p<q;p++){var k=m[p].split("="),n;n=k.shift();n=e.raw?n:decodeURIComponent(n);k=k.join("=");if(d===n){f=c(k,l);break}d||void 0===(k=c(k))||(f[n]=k)}return f};e.defaults={};a.removeCookie=function(b,d){a.cookie(b,"",a.extend({},d,{expires:-1}));return!a.cookie(b)}});
var jscontent=null,itemsFilled=!1,cohost=document.location.href.match(/\.bs2/)?"//co.bs2":"//co.xrayshopping.com",boxberryToken="Aw+IJdwZMl1hMwsdq/uvQA==",boxberryCallback=function(a){$("input[name=delivery_id]").val(1);console.debug(a);var b=cart.get();if(null!=b){var c=a.address.split(",");console.debug(c);$("#_com_form").append('<input type="hidden" name="service_fee" value="'+a.price+'"/>');$("#_com_form").append('<input type="hidden" name="address_postcode" value="'+c[0]+'"/>');$("#_com_form").append('<input type="hidden" name="address_country" value="RU"/>');
$("#_com_form").append('<input type="hidden" name="address_city" value="'+c[1]+'"/>');$("#_com_form").append('<input type="hidden" name="address_address" value="'+c.reverse().splice(0,2).reverse().join()+'"/>');for(var d in b.items)"delivery"==b.items[d].type&&b.items.splice(d,1);b.items.push({title:"Boxberry \u041f\u0412\u0417 "+a.name+"<br/>"+a.address+"<br/>"+a.workschedule+" "+a.phone+"<br/>\u041e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438: "+
a.period,brand:"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430",price:a.price,currency:"RUB",quantity:1,sku:a.id,type:"delivery"});cart.set(b);items(b);$("#_com_main_form_btn_submit").click()}},getQueryByName=function(a,b){b||(b=window.location.href);a=a.replace(/[\[\]]/g,"\\$&");var c=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(b);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null},queryParameters={},__p=window.location.href.match(/\?(.+)$/);
if(null!=__p&&1<__p.length){var __a=__p[1].split(/\&/),i;for(i in __a){var nv=__a[i].split(/=/);queryParameters[nv[0]]=decodeURIComponent(nv[1].replace(/\+/ig," "))}}
var cart={empty:function(){var a=cart.get();if(null!=a&&"undefined"!=typeof a.items)for(var b in a.items)$.post("/cart/delete",{referer:"/basket",itemId:a.items[b].id});$.removeCookie("order")},parse:function(){var a={amount:0,total:0,currency:"EUR",shop_id:"1",response_url:document.location.href,status_id:"0",items:[]};$(".cart-data__item").each(function(){var b=$(this),b={id:b.find(".cart-product").attr("id"),title:b.find(".cart-product__description > .cart-product-description__title").text(),brand:b.find(".cart-product__description > .cart-product-description__manufacturer").text(),
image:b.find(".cart-product > .cart-product__image > a.cart-product-image__link > .cart-product-image__thumbnail").attr("src"),url:b.find(".cart-product > .cart-product__image > a.cart-product-image__link").attr("href"),price:b.find(".cart-price").text().replace(/^\s*(.+?)(&#8381;|\u20bd).*/g,"$1").replace(/\s/,""),currency:"EUR",original_price:b.find(".cart-price .xg_original_converted").text().replace(/^\s*(.+?)(&#8381;|\u20bd).*/g,"$1").replace(/\s/,""),quantity:b.find(".cart-quantity select[name=quantity] option:selected").val(),
sku:b.find(".cart-product__description > .product-no").text().replace(/[^:]+\s*(.+)/,"$1"),type:"product"};a.amount+=b.price*b.quantity;a.total++;a.items.push(b)});$("#_com").trigger("co:parsed",a);return a},create:function(a){$.cookie("order",JSON.stringify(a));return a},set:function(a){var b=cart.get();null==b&&(b={});b=$.extend(b,a);$.cookie("order",JSON.stringify(b));return b},get:function(){return"undefined"!=typeof $.cookie("order")?JSON.parse($.cookie("order")):null},compare:function(a,b){return a.amount!=
b.amount||a.currency!=b.currency?!1:!0}},priceNumber=function(a){var b=null==a?0:a,c=b.toString().replace(/^\s+/,"").replace(/\s+$/,"").split(/\./),d="";if(1E3<=a){a=c[0].split("").reverse();var b=3,e;for(e in a)d+=a[e],0>=--b&&(d+=" ",b=3);c="undefined"==typeof c[1]?"00":c[1];b=d.split("").reverse().join("")+"."+c}return b+"&#8381;"},page={submit:function(){try{if(arguments.length){var a=arguments[0],b={},c=!0;$(a.form+" input,"+a.form+" textarea,"+a.form+" select option:selected").each(function(){var a=
$(this).val(),e=$(this).parent(".-com-form-input"),f=$(this);console.debug(e);if(e.hasClass("-com-input-required")&&0==a.length)return e.addClass("-com-input-required-alert"),f.focus(),c=!1;e.removeClass("-com-input-required-alert");b[$(this).attr("name")]=a});c&&$.ajax({url:$(a.form).attr("data-rel"),dataType:"json",data:b,beforeSend:function(){$(a.form).animate({left:-4E3},400,function(){}).html("").css("left","4000")},success:function(a){a=cart.set(a);$("body").trigger("co:checkout",a)}})}}catch(d){console.error(d),
$(".cart-actions__checkout-link").click()}},input:function(){var a,b="text",c=$.extend({type:"text",name:"name",title:"Label",placeholder:"",required:!1},arguments.length?arguments[0]:{});a='<div class="-com-form-input'+(c.required?" -com-input-required":"");switch(c.type){case "email":a+=" -com-form-input-email";b="text";break;case "phone":a+=" -com-form-input-phone";b="text";break;case "hidden":a+=" -com-form-input-phone",b="hidden"}return a+='"><label for="'+c.name+'">'+c.title+'</label><input type="'+
b+'" name="'+c.name+'" placeholder="'+c.placeholder+'"/></div>'},textarea:function(){var a,b=$.extend({name:"name",title:"Label",placeholder:"",required:!1},arguments.length?arguments[0]:{});a='<div class="-com-form-input'+(b.required?" -com-input-required":"");return a+='"><label for="'+b.name+'">'+b.title+'</label><textarea name="'+b.name+'" placeholder="'+b.placeholder+'"></textarea></div>'},choice:function(){var a,b=$.extend({name:"name",title:"Label",items:[],required:!1},arguments.length?arguments[0]:
{});a='<div class="-com-form-input'+(b.required?" -com-input-required":"");a+='"><label for="'+b.name+'">'+b.title+'</label><input type="hidden" name="'+b.name+'"/>';a+='<ul class="-com-input-choice">';for(var c in b.items)a+='<li><a href="'+b.items[c].action+'">'+b.items[c].option+"</a></li>";return a+"</ul>"}},user=function(a){for(var b in a){var c=a[b];null!=c&&$("textarea[name='user_"+b+"'],select[name='user_"+b+"'],input[name='user_"+b+"']").val(c)}},items=function(a){var b=$("#_com_items"),
c="",d=0;b.html("");for(var e in a.items)var f=a.items[e],c=c+"<tr>",c=c+('<td style="width:55%"><b>'+f.brand+"</b><br/>"+f.title+"</td>"),c=c+('<td style="width:15%">'+priceNumber(f.price)+"</td>"),c=c+('<td style="width:10%">'+f.quantity+"</td>"),c=c+('<td style="width:20%"><b>'+priceNumber(f.price*f.quantity)+"</b></td>"),c=c+"</tr>",d=d+f.price*f.quantity;c=c+'<tr><td style="width:55%">&nbsp;</td><td style="width:15%">&nbsp;</td><td style="width:10%"><h5>\u0418\u0442\u043e\u0433</h5></td>'+('<td style="width:20%"><h5>'+
priceNumber(d)+"</h5></td>");b.append("<table>"+(c+"</tr>")+"</table>");itemsFilled=!0},checkout=function(a){console.debug(a);"4"!=a.status_id&&items(a);var b="id amount currency status_id response_url user_id payment_id delivery_id service_fee card_ref shipping_fee shipping_tracker raw_request".split(" ");$("#_com .-com-modal-header h2").html("\u0417\u0430\u043a\u0430\u0437 #"+a.id);$("#_com #_com_form").attr("data-rel",cohost+"/update");var c=$("#_com #_com_form"),d="";"undefined"!=typeof a.user_id&&
null!=a.user_id&&"null"!=a.user_id&&$.get(cohost+"/user/"+a.user_id,function(a){user(a)});if("0"==a.status_id)$("#_com .-com-modal-header h4").html("\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"),d=d+'<div class="-com-row"><div class="-com-col -com-col-10 -com-offset-1"><h3>\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b \u0434\u043b\u044f \u0441\u0432\u044f\u0437\u0438</h3></div></div><div class="-com-row">'+('<div class="-com-col -com-col-10 -com-offset-1">'+
page.input({type:"email",name:"user_email",title:"E-Mail",placeholder:"email",required:!0})+"</div>"),d+='<div class="-com-col -com-col-10 -com-offset-1">'+page.input({type:"phone",name:"user_phone",title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",placeholder:"\u0442\u0435\u043b\u0435\u0444\u043e\u043d",required:!0})+"</div>",d+="</div>";else if("1"==a.status_id){$("#_com .-com-modal-header h4").html("\u0421\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438");var e=
document.createElement("script");e.setAttribute("src","//points.boxberry.de/js/boxberry.js");document.body.append(e);d=d+'<div class="-com-row">'+('<div class="-com-col -com-col-10 -com-offset-1">'+page.choice({name:"delivery_id",title:"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0441\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",required:!0,items:[{action:"javascript:{boxberry.open(boxberryCallback,'"+boxberryToken+"','\u041c\u043e\u0441\u043a\u0432\u0430','77461',0)}",
option:"\u0414\u043e \u043f\u0443\u043d\u043a\u0442\u0430 \u0432\u044b\u0434\u0430\u0447\u0438 BoxBerry"}]})+"</div></div>")}else if("2"==a.status_id)$("#_com .-com-modal-header h4").html("\u041f\u0430\u0441\u043f\u043e\u0440\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"),d=d+'<div class="-com-row"><div class="-com-col -com-col-12"><h4>\u041f\u0430\u0441\u043f\u043e\u0440\u0442</h4></div></div><div class="-com-row">'+('<div class="-com-col -com-col-4">'+page.input({name:"user_name",
title:"\u0418\u043c\u044f",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f, \u043a\u0430\u043a \u0432 \u043f\u0430\u0441\u043f\u043e\u0440\u0442\u0435",required:!0})+"</div>"),d+='<div class="-com-col -com-col-4">'+page.input({name:"user_middlename",title:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",placeholder:"\u0412\u0430\u0448\u0435 \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e, \u043a\u0430\u043a \u0432 \u043f\u0430\u0441\u043f\u043e\u0440\u0442\u0435",required:!0})+"</div>",
d+='<div class="-com-col -com-col-4">'+page.input({name:"user_lastname",title:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",placeholder:"\u0412\u0430\u0448\u0430 \u0444\u0430\u043c\u0438\u043b\u0438\u044f, \u043a\u0430\u043a \u0432 \u043f\u0430\u0441\u043f\u043e\u0440\u0442\u0435",required:!0})+"</div>",d=d+'</div><div class="-com-row">'+('<div class="-com-col -com-col-4">'+page.input({name:"user_passport_series",title:"\u0421\u0435\u0440\u0438\u044f",placeholder:"99 99",required:!0})+"</div>"),d+=
'<div class="-com-col -com-col-4">'+page.input({name:"user_passport_number",title:"\u041d\u043e\u043c\u0435\u0440",placeholder:"999 999",required:!0})+"</div>",d+='<div class="-com-col -com-col-4">'+page.input({name:"user_passport_date",title:"\u0414\u0430\u0442\u0430",required:!0})+"</div>",d=d+"</div>"+('<div class="-com-row"><div class="-com-col -com-col-12">'+page.textarea({name:"user_passport_issue",title:"\u0412\u044b\u0434\u0430\u043d",required:!0,placeholder:"\u041a\u0435\u043c \u0432\u044b\u0434\u0430\u043d"})+
"</div>");else if("3"==a.status_id)$("#_com #_com_form").attr("data-rel",cohost+"/pay"),$("#_com .-com-modal-header h4").html("\u0421\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b"),"undefined"!=typeof queryParameters.status&&"declined"==queryParameters.status&&"undefined"!=typeof queryParameters.error_message&&(d=d+'<div class="-com-row"><div class="-com-col-10 -com-offset-1 -com-alert-message">'+("<h4>\u041e\u0448\u0438\u0431\u043a\u0430#"+(typeof queryParameters.error_code?
queryParameters.error_code:"-000")+"</h4>"),d+=queryParameters.error_message,d+='</div></div><div class="-com-col-10 -com-offset-1 -com-message">\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u0440\u0443\u0433\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0439 \u0438\u043b\u0438 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u043f\u043b\u0430\u0442\u0435\u0436\u0430</div></div>'),
d=d+'<div class="-com-row">'+('<div class="-com-col -com-col-10 -com-offset-1">'+page.choice({name:"payment_id",title:"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0441\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b",items:[{action:"javascript:{$('input[name=payment_id]').val(1);$('#_com_main_form_btn_submit').click();}",option:"\u041e\u043f\u043b\u0430\u0442\u0430 \u043f\u043e\u0441\u043b\u0435 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"},{action:"javascript:{$('input[name=payment_id]').val(2);$('#_com_main_form_btn_submit').click();}",
option:"\u041e\u043f\u043b\u0430\u0442\u0438\u0442\u044c \u043e\u043d\u043b\u0430\u0439\u043d"}]})+"</div></div>");else if("4.1"==a.status_id){$("#_com .-com-modal-header h4").html("\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u043a\u0430\u0440\u0442\u0443 \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b");$("#_com #_com_form").attr("data-rel",cohost+"/pay");var d=d+'<div class="-com-row">',e={name:"card_id",title:"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u043a\u0430\u0440\u0442\u0443 \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b",
required:!0,items:[]},f;for(f in a.cards){var l=a.cards[f];e.items.push({action:"javascript:{$('input[name=card_id]').val("+l.id+");$('#_com_main_form_btn_submit').click();}",option:l.name})}d+='<div class="-com-col -com-col-10 -com-offset-1">'+page.choice(e)+"</div></div>"}else"4.2"==a.status_id?"undefined"!=typeof a["redirect-url"]&&(document.location.href=a["redirect-url"]):"4"==a.status_id&&(cart.empty(),e=new Date,$("#_com .-com-modal-header h4").html("\u0417\u0430\u043a\u0430\u0437 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d."),
$("#_com_main_form_btn_submit").attr("onclick",'$("#_com").hide();').text("\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),d=d+'<div class="-com-row"><div class="-com-col -com-col-12 -com-message"><h4>\u0417\u0430\u043a\u0430\u0437 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d</h4></div></div><div class="-com-row"><div class="-com-col -com-col-10 -com-offset-1"><b> \u0427\u0435\u043a \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438:</b><br/><pre style="width:26em;margin:0 auto;padding:1em 2em;overflow:none;font-size:120%;">'+
("<b>"+queryParameters.descriptor),d=d+"</b><br/>-------------------------------------"+('<br/>\u0414\u0430\u0442\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438:<span style="float:right;font-weight:700">'+("undefined"!=typeof queryParameters.tx_date?queryParameters.tx_date:e.toDateString())+"</span>"),d+='<br/>\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430:<span style="float:right;font-weight:700">'+a.id+"</span>",d+='<br/>\u0422\u0435\u0440\u043c\u0438\u043d\u0430\u043b:<span style="float:right;font-weight:700">'+
("undefined"!=typeof queryParameters.endpoint?queryParameters.endpoint:"----")+"</span>",d+='<br/>\u041c\u0430\u0433\u0430\u0437\u0438\u043d:<span style="float:right;font-weight:700">'+document.location.host+"</span>",d+='<br/>\u041a\u0430\u0440\u0442\u0430:<span style="float:right;font-weight:700">'+queryParameters.bin+"xxxxxx"+queryParameters["last-four-digits"]+"</span>",d+='<br/>\u0421\u0443\u043c\u043c\u0430 (\u0440\u0443\u0431.):<span style="float:right;font-weight:700">'+("undefined"!=typeof queryParameters.amount?
queryParameters.amount:1)+"</span>",d+='<br/>\u041a\u043e\u0434 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438:<span style="float:right;font-weight:700">'+queryParameters["processor-tx-id"]+"</span>",d+="<br/>-------------------------------------</pre></div></div>");c.html(d).animate({left:0},400);for(f in a)-1!=b.indexOf(f)&&"null"!=a[f]&&null!=a[f]&&"raw_request"!=f&&c.append('<input type="hidden" name="'+f+'" value="'+a[f]+'"/>')};
$(document).ready(function(){$(".ajax-cart__action-link").attr("href","/basket").html("\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437");$("body").on("co:checkout",function(a,b){checkout(b)});$(".cart-actions__checkout-link").attr("href","javascript:{0}").html("\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437").on("click",function(a){jscontent=$("#_com");a.preventDefault();a.stopPropagation();$(".overlay").hide();$(".show-ajax-cart").hide();
var b=cart.parse();jscontent.length?$("#_com").show():$.get(cohost+"/com.html",function(a){$("body").append(a);a=cart.get();null!=a&&cart.compare(a,b)&&"undefined"!=typeof a.id?(order=a,$("body").trigger("co:checkout",order)):(cart.set(b),$.ajax({url:cohost+"/create",crossDomain:!0,data:b,success:function(a){a=cart.set(a);$("body").trigger("co:checkout",a)}}));$("body").trigger("co:loaded")});return!1});"undefined"!=typeof queryParameters._com_response&&(cart.set({status_id:typeof queryParameters.status_id?
queryParameters.status_id:"3"}),$(".cart-actions__checkout-link").click())});
